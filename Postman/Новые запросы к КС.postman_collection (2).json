{
	"info": {
		"_postman_id": "4643bba4-2e24-46eb-be0c-84d6fe306065",
		"name": "Новые запросы к КС",
		"description": "## О коллекции в Постмане\n\nКоллекцию поддерживают в актуальном состоянии тестировщики Маркет.Кассы. Она размещена в командном пространстве, где все участники могут работать одновременно. Для этого нужно соблюдать несколько принципов:\n\n1. В текущих переменных коллекции \"Новые запросы к КС\" можно менять CurrentValue на свои значения: CurrentValue уникальные для каждого пользователя. Но нельзя трогать InitialValue - так вы можете помешать другим тестировщикам, а также сломать скрипты из prerequests-scripts.\n2. При добавлении новых функций делаем так, чтобы ими могли пользоваться другие. Для новых переменных как раз задаем InitialValue. И проверяем на дополнительном аккаунте, что функции действительно работают не только у вас.\n3. Если хочется поэкспериментировать с коллекцией - форкаем её в свое личное пространство (или экспортируем/импортируем себе).\n    \n\nСейчас есть такие фичи (и пользоваться ими можно, меняя CurrentValue)\n\n1. Переключение между стейджами. Просто замените в переменной base_url с market.testkontur на market-dev.testkontur - и все запросы будут отправляться на второй КС.\n2. Отправка запросов перед выполнением текущего запроса. Заходим в prerequests-scripts и достаём значение переменной prepare_request. Это не простая переменная, а функция. Чтобы превратить её из строки в функцию, используем eval. Выглядит это так: eval(pm.collectionVariables.get(\"prepare_request\")); Дальше мы вызываем функцию, которой передаём соответствующий хвост (часть запроса после cashbox/cashboxId). Выглядит так: pm.sendRequest(prepareRequest('shift'), (error, response) => {do something}); Пример - посмотрите в prerequest-scripts в запросах \"Чеки из последней смены\" и \"Создать кассира в один клик\".\n3. Представление json в виде таблицы. Пример - смотрите в Tests в запросе \"Чеки из последней смены\"\n    \n\n## О Кассовом сервере\n\nКассовый сервер (КС) нужен для обмена данными между товароучетной системой и локальным кассовым ПО (касса).\n\nПредставляет собой _облачное_ хранилище данных:\n\n- Справочники из товароучетной системы (Товары, Кассиры, Плитки, Скидки)\n- Документы с касс (Чеки продажи/возврата, Чеки коррекции, Документы внесения/выема наличности, Итоговые данные смен)\n- Логи\n    \n\n## Передача справочников на КС\n\nКаждый раз на КС передается только данные справочника, которые были добавлены или изменены в товароучетной системе. На КС не отправляются повторно одни и те же данные, тем самым минимизируя трафик передачи.  \nРазницу вычисляет товароучетная система перед передачей данных на сервер.\n\nКаждой передаче справочника присваивается версия. Версия справочника - натуральное число, от нуля до бесконечности. Версия 0 означает, что справочник еще не загружен.\n\n## Передача справочников на кассу\n\nКасса запрашивает последнюю версию справочника на сервере. Если последняя версия справочника отличается от той,  \nчто используется на кассе, то кассой инициируется процедура получения последнего справочника.\n\nСервер умеет отдавать разницу только между двумя соседними версиями справочников.\n\nЕсли последняя версия справочника на сервере отличается больше чем на единицу от версии справочника на кассе, то кассе нужно сделать столько запросов на сервер, сколько разница между версиями.\n\nПосле успешного получения новой версии справочника, касса отправляет на сервер принятую версию справочника, сигнализируя серверу, что новая версия успешно получена.\n\n## Авторизация\n\n### Создание новой кассы в товароучетной системе\n\nИз товароучетной системы отправляется запрос на КС для создания новой кассы.\n\nПри успешном создании кассы КС возвращает ответ `200 ОК` и создает сущность новой кассы.\n\nДля дальнейшего взаимодействия с кассой нужно прописывать в запросах id кассы.\n\n### Запросы к КС\n\nАвторизация запросов товароучетных систем к REST API происходит при помощи HTTP Basic Auth. Во всех запросах необходимо передавать заголовок `Authorization: Basic`",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "26054325"
	},
	"item": [
		{
			"name": "v1",
			"item": [
				{
					"name": "Товары",
					"item": [
						{
							"name": "Получить каталог",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/product",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"product"
									]
								},
								"description": "Метод для ручного тестирования, диагностики проблем на кассе"
							},
							"response": []
						},
						{
							"name": "Обновить каталог",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/product",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"product"
									]
								},
								"description": "Касса генерирует эвент (CatalogUploaded) в ленту событий для оповещения товароучетной системы, что номенклатура успешно загружена"
							},
							"response": []
						},
						{
							"name": "Получить последнюю версию",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/product/version/latest",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"product",
										"version",
										"latest"
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить используемую версию",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/product/version/used",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"product",
										"version",
										"used"
									]
								},
								"description": "Метод для ручного тестирования, диагностики проблем на кассе"
							},
							"response": []
						}
					]
				},
				{
					"name": "Остатки товаров",
					"item": [
						{
							"name": "Остатки. Получить остатки товаров",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "psw",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/productBalance",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"productBalance"
									]
								}
							},
							"response": []
						},
						{
							"name": "Остатки. Обновить справочник остатков товаров",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "psw",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n    \"previousVersion\": 1,\r\n    \"diff\": {\r\n        \"Deleted\": [],\r\n        \"Updated\": [{\r\n            \"id\": \"ed0dddf2-c2b2-4160-9ece-4a9e03b2e828\",\r\n            \"balance\": 557.0\r\n        }]\r\n    }\r\n}"
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/productBalance",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"productBalance"
									]
								}
							},
							"response": []
						},
						{
							"name": "БС: остатки по товарным позициям ТТ (запрос в BalancesService)",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"url": {
									"raw": "http://CLD-ALKO-HST8:18150/api/balance/shops/:shopId/rests",
									"protocol": "http",
									"host": [
										"CLD-ALKO-HST8"
									],
									"port": "18150",
									"path": [
										"api",
										"balance",
										"shops",
										":shopId",
										"rests"
									],
									"variable": [
										{
											"key": "shopId",
											"value": "d45de133-04dd-4256-971a-5b158f4808fb"
										}
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Блюда",
					"item": [
						{
							"name": "Получить справочник цехов",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "psw",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/kitchenStation",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"kitchenStation"
									]
								},
								"description": "Запрашиваются все существующие кассы с КС"
							},
							"response": []
						},
						{
							"name": "Получить справочник блюд",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "psw",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/dish",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"dish"
									]
								},
								"description": "Запрашиваются все существующие кассы с КС"
							},
							"response": []
						},
						{
							"name": "Обновить справочник блюд",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "psw",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n    \"diff\": {\r\n        \"DeletedIds\": [],\r\n        \"Updated\": [\r\n            {\r\n                \"Id\": \"4f14d1d5-39e7-aa54-74d5-4267e0d10e7a\",\r\n                \"KitchenStationId\": \"4d9821e7-5ae0-4df6-9d28-4d97f1341147\"\r\n            }\r\n        ]\r\n    },\r\n    \"previousVersion\": 1\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/dish",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"dish"
									]
								},
								"description": "Запрашиваются все существующие кассы с КС"
							},
							"response": []
						},
						{
							"name": "Обновить справочник цехов на кассе",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "psw",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n    \"diff\": {\r\n        \"DeletedIds\": [],\r\n        \"Updated\": [\r\n            {\r\n                \"Id\": \"{{$guid}}\",\r\n                \"Name\": \"Бар\",\r\n                \"Type\": \"Бар\"\r\n            },\r\n            {\r\n                \"Id\": \"{{$guid}}\",\r\n                \"Name\": \"Кухня\",\r\n                \"Type\": \"Кухня\"\r\n            },\r\n            {\r\n                \"Id\": \"{{$guid}}\",\r\n                \"Name\": \"Горячий\",\r\n                \"Type\": \"Горячий\"\r\n            },\r\n            {\r\n                \"Id\": \"{{$guid}}\",\r\n                \"Name\": \"Холодный\",\r\n                \"Type\": \"Холодный\"\r\n            }\r\n        ]\r\n    },\r\n    \"previousVersion\": 0\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/kitchenStation",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"kitchenStation"
									]
								},
								"description": "Запрашиваются все существующие кассы с КС"
							},
							"response": []
						}
					]
				},
				{
					"name": "Касса",
					"item": [
						{
							"name": "Получить состояние кассы",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/state",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"state"
									]
								}
							},
							"response": []
						},
						{
							"name": "Сообщить КС, о том что документы были загруженны на кассу.",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/state/documentFetched",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"state",
										"documentFetched"
									]
								}
							},
							"response": []
						},
						{
							"name": "Обновить подписки кассы",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/state/updateServiceSubscription",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"state",
										"updateServiceSubscription"
									]
								}
							},
							"response": []
						},
						{
							"name": "Пинг",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/ping/",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"ping",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить текущие версии настроек на КС",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/settings/version/latest",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"settings",
										"version",
										"latest"
									]
								},
								"description": "Метод для ручного тестирования"
							},
							"response": []
						},
						{
							"name": "Получить версии настроек, используемых на кассе",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/settings/version/used",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"settings",
										"version",
										"used"
									]
								}
							},
							"response": []
						},
						{
							"name": "Указать на КС версии настроек, используемых на кассе",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/settings/version/used",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"settings",
										"version",
										"used"
									]
								}
							},
							"response": []
						},
						{
							"name": "BackendApi Получить список касс",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox"
									]
								},
								"description": "Запрашиваются все существующие кассы с КС"
							},
							"response": []
						},
						{
							"name": "Получить кассу",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Создать кассу",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "Данные для создания"
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Создать токен",
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\r\n    \"Token\": \"11111112\"\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/resetPassword",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"resetPassword"
									]
								}
							},
							"response": []
						},
						{
							"name": "Удалить кассу",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/delete",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"delete"
									]
								},
								"description": "После отвязки кассы нельзя будет отправить данные для кассы на КС.\r\n                Удаленную кассу можно восстановить по cashboxId отдельным методом.\r\n                Касса не сможет забирать с сервера справочники и загружать документы"
							},
							"response": []
						},
						{
							"name": "Восстановить кассу",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/restore",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"restore"
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить настройки кассы с КС",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/settings",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"settings"
									]
								}
							},
							"response": []
						},
						{
							"name": "Обновить backendSettings",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{ \"Settings\": {\r\n            \"address\": \"ул. Малопрудная г. Екатеринбург\",\r\n            \"inn\": \"825933082608\",\r\n            \"kpp\": \"\",\r\n            \"shopName\": \"Миша тестит\",\r\n            \"cashboxName\": \"24102022\",\r\n            \"synchronizationInterval\": \"00:05:00\",\r\n            \"moveRemainsToNextShift\": true,\r\n            \"weightBarcodePrefix\": \"28\",\r\n            \"prepaidEnabled\": false,\r\n            \"receiptSettings\": {\r\n                \"headerText\": [\r\n                    \"Добро\",\r\n                    \"пожаловатьf!\"\r\n                ],\r\n                \"footerText\": [\r\n                    \"Спасибо за\",\r\n                    \"покупку!\"\r\n                ]\r\n            },\r\n            \"roundSettings\": \"none\",\r\n            \"workerEnabled\": false,\r\n            \"customerEnabled\": false,\r\n            \"freeSaleSettings\": null,\r\n            \"egaisSettings\": {\r\n                \"alcoholSaleTimeSettings\": null\r\n            },\r\n            \"integratedTerminalEnabled\": null,\r\n            \"agentEnabled\": false,\r\n            \"tobaccoDatamatrixRequest\": null,\r\n            \"markingEnabled\": false,\r\n            \"printerEnabled\": true,\r\n            \"orderNumberPrefix\": null,\r\n            \"medicineSettings\": null,\r\n            \"markingCodeValidationSettings\": null,\r\n            \"alcoMarkValidationSettings\": null,\r\n            \"loyaltyToken\": \"222d7c0a-d3d4-4155-b7cb-819da22e1df9\",\r\n            \"customersSettings\": null,\r\n            \"fasterPaymentSystemSettings\": null,\r\n            \"productBalanceSettings\": null,\r\n            \"ytipsUrl\": null,\r\n            \"loyaltyQrPrintingEnabled\": false,\r\n            \"amountPrintSlip\": null\r\n        },\r\n        \"previousVersion\": 2\r\n}"
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/settings/backend",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"settings",
										"backend"
									]
								},
								"description": "Обновление настроек на КС с изменением версии"
							},
							"response": []
						},
						{
							"name": "Обновить appSettings",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "Тело запроса"
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/settings/app",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"settings",
										"app"
									]
								},
								"description": "Метод нужен для исключительных случаях (обращение в ТП), когда нужно вручную поменять настройки приложения"
							},
							"response": []
						},
						{
							"name": "Получить serviceInfo",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/serviceInfo",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"serviceInfo"
									]
								},
								"description": "Возвращает данные по кассе за все время"
							},
							"response": []
						}
					]
				},
				{
					"name": "Кассиры",
					"item": [
						{
							"name": "Получить все элементы справочника, загруженного на кассу",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/cashier",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"cashier"
									]
								},
								"description": "Метод для ручного тестирования, диагностики проблем на кассе"
							},
							"response": []
						},
						{
							"name": "Загрузить обновленный справочник на КС",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n  \"diff\": {\r\n    \"DeletedIds\": [],\r\n    \"Updated\": [\r\n      {\r\n            \"password\": null,\r\n            \"accessRights\": [\r\n\"RemoveLine\",\r\n\"CreateReceiptToReturn\",\r\n\"BrowseFinancialSummary\",\r\n\"BrowseReceipts\",\r\n\"ProductsStatistics\",\r\n\"PrintReports\",\r\n\"BrowseClosedShifts\",\r\n\"CorrectionReceipts\",\r\n\"PostponedReceipts\",\r\n\"InsertionsAndWithdrawals\",\r\n\"CashboxSettings\",\r\n\"EditingPriceAndDiscount\",\r\n\"AcceptanceOfCashPayments\",\r\n\"SaleOfTobacco\",\r\n\"SaleOfClothes\",\r\n\"SaleOfShoes\",\r\n\"SaleOfMilkProducts\",\r\n\"SaleOfWater\",\r\n\"SaleOfTires\",\r\n\"SaleOfPerfume\",\r\n\"SaleOfPhotoEquipment\",\r\n\"SaleOfMedicine\",\r\n\"AllowedClosingShift\"\r\n            ],\r\n            \"id\": \"c1cbd30a-3ccb-4a17-a8f0-b73935b49624\",\r\n            \"name\": \"Миша2\",\r\n            \"inn\": null,\r\n            \"role\": \"administrator\"\r\n      }\r\n    ]\r\n  },\r\n  \"previousVersion\": 1\r\n}\r\n\r\n\r\n"
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/cashier",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"cashier"
									]
								}
							},
							"response": []
						},
						{
							"name": "Создать кассира в один клик",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"prepareRequest = eval(pm.collectionVariables.get(\"prepare_request\")); \r",
											"\r",
											"pm.sendRequest(prepareRequest('catalog/cashier'), (error, response) => {\r",
											"    if (error){\r",
											"        console.log(error)\r",
											"    }\r",
											"    cashier_version = Number(response.json()[\"version\"]);\r",
											"    pm.collectionVariables.set(\"cashier_version\", cashier_version);\r",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n  \"diff\": {\r\n    \"DeletedIds\": [],\r\n    \"Updated\": [\r\n      {\r\n            \"password\": null,\r\n            \"accessRights\": [\r\n\"RemoveLine\",\r\n\"CreateReceiptToReturn\",\r\n\"BrowseFinancialSummary\",\r\n\"BrowseReceipts\",\r\n\"ProductsStatistics\",\r\n\"PrintReports\",\r\n\"BrowseClosedShifts\",\r\n\"CorrectionReceipts\",\r\n\"PostponedReceipts\",\r\n\"InsertionsAndWithdrawals\",\r\n\"CashboxSettings\",\r\n\"EditingPriceAndDiscount\",\r\n\"AcceptanceOfCashPayments\",\r\n\"SaleOfTobacco\",\r\n\"SaleOfClothes\",\r\n\"SaleOfShoes\",\r\n\"SaleOfMilkProducts\",\r\n\"SaleOfWater\",\r\n\"SaleOfTires\",\r\n\"SaleOfPerfume\",\r\n\"SaleOfPhotoEquipment\",\r\n\"SaleOfMedicine\",\r\n\"AllowedClosingShift\"\r\n            ],\r\n            \"id\": \"c1cbd30a-3ccb-4a17-a8f0-b73935b49624\",\r\n            \"name\": \"Кассир со всеми правами (gen)\",\r\n            \"inn\": null,\r\n            \"role\": \"administrator\"\r\n      }\r\n    ]\r\n  },\r\n  \"previousVersion\": {{cashier_version}}\r\n}\r\n\r\n\r\n"
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/cashier",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"cashier"
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить версию справочника, используемого на кассе",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/cashier/version/used",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"cashier",
										"version",
										"used"
									]
								},
								"description": "Метод для ручного тестирования, диагностики проблем на кассе"
							},
							"response": []
						},
						{
							"name": "Получить последнюю версию справочника, загруженного на КС",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/cashier/version/latest",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"cashier",
										"version",
										"latest"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Чеки коррекции",
					"item": [
						{
							"name": "Получить чек коррекции",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/shift/:shiftId/correctionReceipt/:id",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"shift",
										":shiftId",
										"correctionReceipt",
										":id"
									],
									"variable": [
										{
											"key": "shiftId",
											"value": "{{shiftId}}"
										},
										{
											"key": "id",
											"value": "{{id}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить все чеки коррекции за смену",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/shift/:shiftId/correctionReceipt",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"shift",
										":shiftId",
										"correctionReceipt"
									],
									"variable": [
										{
											"key": "shiftId",
											"value": "ac095022-16c9-4859-9141-334f0e5dc9fb"
										}
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Скидки",
					"item": [
						{
							"name": "Получить все элементы справочника, загруженного на кассу",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/discount",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"discount"
									]
								},
								"description": "Метод для ручного тестирования, диагностики проблем на кассе"
							},
							"response": []
						},
						{
							"name": "Загрузить обновленный справочник на КС",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/discount",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"discount"
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить версию справочника, используемого на кассе",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/discount/version/used",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"discount",
										"version",
										"used"
									]
								},
								"description": "Метод для ручного тестирования, диагностики проблем на кассе"
							},
							"response": []
						},
						{
							"name": "Получить последнюю версию справочника, загруженного на КС",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/discount/version/latest",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"discount",
										"version",
										"latest"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Лента событий",
					"item": [
						{
							"name": "Получение текущих указателей с лент событий",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/events/pointer",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"events",
										"pointer"
									]
								},
								"description": "Метод возвращает массив указателей."
							},
							"response": []
						},
						{
							"name": "Получение событий с определенного указателя",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "Указатель на ленте событий"
								},
								"url": {
									"raw": "{{base_url}}/v1/events?count={{count}}",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"events"
									],
									"query": [
										{
											"key": "count",
											"value": "{{count}}"
										}
									]
								},
								"description": "Метод возвращает массив указателей последних событий и список событий по каждо ленте."
							},
							"response": []
						},
						{
							"name": "Получение событий с какого-то момента времени",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/events?dateTime={{dateTime}}&count={{count}}",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"events"
									],
									"query": [
										{
											"key": "dateTime",
											"value": "{{dateTime}}"
										},
										{
											"key": "count",
											"value": "{{count}}"
										}
									]
								},
								"description": "Метод нужен для тестовых целей и когда нужно вытащить информацию за конкретный период.\r\n            Метод возвращает массив указателей последних событий и список событий по каждо ленте."
							},
							"response": []
						}
					]
				},
				{
					"name": "Смена",
					"item": [
						{
							"name": "Получить список смен",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/shift",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"shift"
									],
									"query": [
										{
											"key": "from",
											"value": "2021-08-05T11:13:30.6986055+05:00",
											"disabled": true
										},
										{
											"key": "to",
											"value": "2021-07-08T11:54:29.3736144+00:00",
											"disabled": true
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить все документы за смену",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/shift/:shiftId/receipt",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"shift",
										":shiftId",
										"receipt"
									],
									"variable": [
										{
											"key": "shiftId",
											"value": "{{shiftId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить документ",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/shift/:shiftId/moneyDocument/:id",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"shift",
										":shiftId",
										"moneyDocument",
										":id"
									],
									"variable": [
										{
											"key": "shiftId",
											"value": "{{shiftId}}"
										},
										{
											"key": "id",
											"value": "2"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить чек в смене",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/shift/:shiftId/receipt/:id",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"shift",
										":shiftId",
										"receipt",
										":id"
									],
									"variable": [
										{
											"key": "shiftId",
											"value": "{{shiftId}}"
										},
										{
											"key": "id",
											"value": "dde79108-f946-49b6-ad1f-13fb5833d3dd"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить смену - id не подходят для др запросов",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/shift/:shiftId",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"shift",
										":shiftId"
									],
									"variable": [
										{
											"key": "shiftId",
											"value": "1"
										}
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Плитки",
					"item": [
						{
							"name": "Получить все элементы справочника, загруженного на кассу",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/tile",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"tile"
									]
								},
								"description": "Метод для ручного тестирования, диагностики проблем на кассе"
							},
							"response": []
						},
						{
							"name": "Загрузить обновленный справочник на КС",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/tile",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"tile"
									]
								}
							},
							"response": []
						},
						{
							"name": "Получить версию справочника, используемого на кассе",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/tile/version/used",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"tile",
										"version",
										"used"
									]
								},
								"description": "Метод для ручного тестирования, диагностики проблем на кассе"
							},
							"response": []
						},
						{
							"name": "Получить последнюю версию справочника, загруженного на КС",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/catalog/tile/version/latest",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"catalog",
										"tile",
										"version",
										"latest"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Чеки",
					"item": [
						{
							"name": "Чек",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/shift/:shiftId/receipt",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"shift",
										":shiftId",
										"receipt"
									],
									"variable": [
										{
											"key": "shiftId",
											"value": "3b12dded-e3ca-4f32-8068-67430ed14527"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Заказы",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/v2/orders?cashboxId={{cashboxId}}",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v2",
										"orders"
									],
									"query": [
										{
											"key": "cashboxId",
											"value": "{{cashboxId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Заказы с визуализацией",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"var template = ` \r",
											"    <style type=\"text/css\">\r",
											"        .tftable {font-size:14px;color:#333333;width:100%;\r",
											"        border-width: 1px;border-color: #87ceeb;border-collapse: collapse;}\r",
											"        .tftable th {font-size:18px;background-color:#87ceeb;border-width: 1px;\r",
											"        padding: 8px;border-style: solid;border-color: #87ceeb;text-align:left;}\r",
											"        .tftable tr {background-color:#ffffff;}\r",
											"        .tftable td {font-size:14px;border-width: 1px;padding: 8px;\r",
											"        border-style: solid;border-color: #87ceeb;}\r",
											"        .tftable tr:hover {background-color:#e0ffff;}\r",
											"    </style>\r",
											"    <table class=\"tftable\" border=\"1\">\r",
											"        <tr>\r",
											"            <th> Тип чека </th>\r",
											"            <th> Номер </th>\r",
											"            <th> Дата </th>\r",
											"            <th> Статус </th>\r",
											"            <th> Сумма чека </th>\r",
											"\t\t\t<th> Позиции </th>\r",
											"        </tr>\r",
											"{{#each response}}\r",
											"            <tr>\r",
											"                <td>{{direction}}</td>\r",
											"                <td>{{number}}</td>\r",
											"                <td>{{endDateTime}}</td>\r",
											"                <td>{{status}}</td>\r",
											"\t\t\t\t<td>{{totalSum}}</td>\r",
											"                <td>\r",
											"                <table class=\"tftable\" border=\"1\">\r",
											"                <tr>\r",
											"                <th> Цена позиции </th>\r",
											"                <th> Цена штуки </th>\r",
											"                <th> Количество </th>\r",
											"                <th> Название</th>\r",
											"                <th> Тип </th>\r",
											"                <th> Марка </th>\r",
											"                \r",
											"                </tr>\r",
											"                {{#each positions}}\r",
											"                <tr>\r",
											"                <td>{{totalSum}}</td>\r",
											"                <td>{{finalPricePerUnit}}</td>\r",
											"                <td>{{quantity}}</td>\r",
											"                <td>{{product.name}}</td>\r",
											"                <td>{{product.type}}</td>\r",
											"                <td>{{itemCode}}</td>                \r",
											"                </tr>\r",
											"                {{/each}}\r",
											"                </table>\r",
											"                </td>\r",
											"            </tr>\r",
											"            \r",
											"           {{/each}}\r",
											"    </table>`;\r",
											"\t\r",
											"pm.visualizer.set(template, {response: pm.response.json()});\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/v2/orders?cashboxId={{cashboxId}}",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v2",
										"orders"
									],
									"query": [
										{
											"key": "cashboxId",
											"value": "{{cashboxId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Чеки из последней смены",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"prepareRequest = eval(pm.collectionVariables.get(\"prepare_request\")); \r",
											"\r",
											"pm.sendRequest(prepareRequest('shift'), (error, response) => {\r",
											"    if (error){\r",
											"        console.log(error)\r",
											"    }\r",
											"    lastShiftId = getLastShiftId(response.json())\r",
											"    pm.collectionVariables.set(\"shiftId\", lastShiftId);\r",
											"});\r",
											"\r",
											"function getLastShiftId(data){\r",
											"    var d = new Date();\r",
											"    var maxDate = new Date(d.setDate(d.getDate()-1500));\r",
											"\r",
											"    for (var i = 0; i < data.length; i++){\r",
											"        shift_date = new Date(Date.parse(data[i].openInfo.openDateTime))\r",
											"        if (shift_date >= maxDate) {\r",
											"            maxDate = shift_date\r",
											"        }\r",
											"    }\r",
											"\r",
											"    for (var j = 0; j < data.length; j++){\r",
											"        if (new Date(Date.parse(data[j].openInfo.openDateTime)).getTime() == maxDate.getTime()){\r",
											"            return data[j].id\r",
											"        }\r",
											"    }\r",
											"}"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"var template = ` \r",
											"    <style type=\"text/css\">\r",
											"        .tftable {font-size:14px;color:#333333;width:100%;\r",
											"        border-width: 1px;border-color: #87ceeb;border-collapse: collapse;}\r",
											"        .tftable th {font-size:18px;background-color:#87ceeb;border-width: 1px;\r",
											"        padding: 8px;border-style: solid;border-color: #87ceeb;text-align:left;}\r",
											"        .tftable tr {background-color:#ffffff;}\r",
											"        .tftable td {font-size:14px;border-width: 1px;padding: 8px;\r",
											"        border-style: solid;border-color: #87ceeb;}\r",
											"        .tftable tr:hover {background-color:#e0ffff;}\r",
											"    </style>\r",
											"    <table class=\"tftable\" border=\"1\">\r",
											"        <tr>\r",
											"            <th> Тип чека </th>\r",
											"            <th> Номер </th>\r",
											"            <th> Дата </th>\r",
											"            <th> Сумма чека </th>\r",
											"\t\t\t<th> Позиции </th>\r",
											"        </tr>\r",
											"{{#each response}}\r",
											"            <tr>\r",
											"                <td>{{type}}</td>\r",
											"                <td>{{fiscalInfo.fiscalDocumentNumber}}</td>\r",
											"                <td>{{fiscalInfo.documentDate}}</td>\r",
											"\t\t\t\t<td>{{totalSum}}</td>\r",
											"                <td>\r",
											"                <table class=\"tftable\" border=\"1\">\r",
											"                <tr>\r",
											"                <th> Цена позиции </th>\r",
											"                <th> Цена штуки </th>\r",
											"                <th> Количество </th>\r",
											"                <th> Название</th>\r",
											"                <th> Тип </th>\r",
											"                <th> Марка </th>\r",
											"                \r",
											"                </tr>\r",
											"                {{#each lines}}\r",
											"                <tr>\r",
											"                <td>{{totalSum}}</td>\r",
											"                <td>{{finalPricePerUnit}}</td>\r",
											"                <td>{{quantity}}</td>\r",
											"                <td>{{product.name}}</td>\r",
											"                <td>{{product.type}}</td>\r",
											"                <td>{{exciseMark}}</td>\r",
											"                \r",
											"                </tr>\r",
											"                {{/each}}\r",
											"                </table>\r",
											"                </td>\r",
											"            </tr>\r",
											"            \r",
											"           {{/each}}\r",
											"    </table>`;\r",
											"\t\r",
											"pm.visualizer.set(template, {response: pm.response.json()});\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/shift/{{shiftId}}/receipt",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"shift",
										"{{shiftId}}",
										"receipt"
									]
								}
							},
							"response": []
						},
						{
							"name": "Чеки коррекции",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/shift/:shiftId/correctionReceipt",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"shift",
										":shiftId",
										"correctionReceipt"
									],
									"variable": [
										{
											"key": "shiftId",
											"value": "{{shiftId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Отложенные чеки",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{base_url}}/v1/cashbox/{{cashboxId}}/postponedReceipt",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"v1",
										"cashbox",
										"{{cashboxId}}",
										"postponedReceipt"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Акции",
					"item": [
						{
							"name": "Все акции (магазин)",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"url": {
									"raw": "http://CLD-ALKO-HST5:16381/promotionsApi/shops/d45de133-04dd-4256-971a-5b158f4808fb/promotions",
									"protocol": "http",
									"host": [
										"CLD-ALKO-HST5"
									],
									"port": "16381",
									"path": [
										"promotionsApi",
										"shops",
										"d45de133-04dd-4256-971a-5b158f4808fb",
										"promotions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Все акции (Демо 2)",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"url": {
									"raw": "http://CLD-ALKO-HST9:13019/promotionsApi/shops/d6238bdd-ab5b-4d88-82d1-e220ba652187/promotions",
									"protocol": "http",
									"host": [
										"CLD-ALKO-HST9"
									],
									"port": "13019",
									"path": [
										"promotionsApi",
										"shops",
										"d6238bdd-ab5b-4d88-82d1-e220ba652187",
										"promotions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Добавить акцию (Магазин)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "Authorization",
										"value": "Bearer 95668c14-2895-479c-8a5b-317ecb40c3d1",
										"type": "text",
										"disabled": true
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n    \"idempotencyKey\": \"e5bc3bd0-6ebc-4c49-abee-56b1e7fe3b40\",\r\n    \"name\": \"Акция  хлеб + вода 10%\",\r\n    \"period\": { \"type\": \"DailyPartOfDay\", \"from\": \"00:00:00\", \"to\": \"23:50:00\" },\r\n    \"discount\": 10.0,\r\n    \"productIds\": [\r\n        \"dde28d1c-9fe1-5d1e-337e-4d1abfd37026\",\r\n        \"e16cddb1-2b96-2844-4e65-236b55569647\"\r\n        ],\r\n    \"isActive\": true \r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://CLD-ALKO-HST5:16381/promotionsApi/shops/d45de133-04dd-4256-971a-5b158f4808fb/promotions",
									"protocol": "http",
									"host": [
										"CLD-ALKO-HST5"
									],
									"port": "16381",
									"path": [
										"promotionsApi",
										"shops",
										"d45de133-04dd-4256-971a-5b158f4808fb",
										"promotions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Добавить акцию (Демо 2)",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n    \"idempotencyKey\": \"b3e16e06-4e59-491f-8ffd-619289efdf65\",\r\n    \"name\": \"Акция 6\",\r\n    \"period\": { \"type\": \"DailyPartOfDay\", \"from\": \"00:00:00\", \"to\": \"23:59:00\" },\r\n    \"discount\": 10,\r\n    \"productIds\": [\"5a436481-0351-47be-86cd-88dea4947c94\"],\r\n    \"isActive\": true \r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://CLD-ALKO-HST9:13019/promotionsApi/shops/d6238bdd-ab5b-4d88-82d1-e220ba652187/promotions",
									"protocol": "http",
									"host": [
										"CLD-ALKO-HST9"
									],
									"port": "13019",
									"path": [
										"promotionsApi",
										"shops",
										"d6238bdd-ab5b-4d88-82d1-e220ba652187",
										"promotions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Изменить акцию",
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n    \"name\": \"Акция  хлеб + вода 10%\",\r\n    \"productIds\": [\r\n        \"dde28d1c-9fe1-5d1e-337e-4d1abfd37026\",\r\n                \"e16cddb1-2b96-2844-4e65-236b55569647\"\r\n    ],\r\n    \"period\": {\r\n            \"type\": \"dailyPartOfDay\",\r\n            \"from\": \"09:58:00\",\r\n            \"to\": \"17:40:00\"\r\n        },\r\n    \"discount\": 10.0,\r\n    \"isActive\": false\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://CLD-ALKO-HST5:16381/promotionsApi/shops/d45de133-04dd-4256-971a-5b158f4808fb/promotions/0c8bce74-35b4-40a3-8472-f8439b4c8659",
									"protocol": "http",
									"host": [
										"CLD-ALKO-HST5"
									],
									"port": "16381",
									"path": [
										"promotionsApi",
										"shops",
										"d45de133-04dd-4256-971a-5b158f4808fb",
										"promotions",
										"0c8bce74-35b4-40a3-8472-f8439b4c8659"
									]
								}
							},
							"response": []
						},
						{
							"name": "Удалить акцию",
							"request": {
								"method": "DELETE",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"url": {
									"raw": "http://CLD-ALKO-HST5:16381/promotionsApi/shops/d45de133-04dd-4256-971a-5b158f4808fb/promotions/f1c8abb1-0ccb-4081-8eac-ce60d4fe85b1",
									"protocol": "http",
									"host": [
										"CLD-ALKO-HST5"
									],
									"port": "16381",
									"path": [
										"promotionsApi",
										"shops",
										"d45de133-04dd-4256-971a-5b158f4808fb",
										"promotions",
										"f1c8abb1-0ccb-4081-8eac-ce60d4fe85b1"
									]
								}
							},
							"response": []
						},
						{
							"name": "Получение токена лояльности (Магазин)",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\"token\": \"f6a9c0b1-00d1-411b-af68-5b10fcab65fa\",\r\n\"shopId\": \"760a5ab7-0d8d-4d76-befe-5d40caceb088\",\r\n\"cashboxId\": \"782ecfe4-ee3c-4d97-9794-086e8c3af180\"\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://CLD-ALKO-HST7:14213/loyaltyApi/organizations/b9097317-ba90-4354-9da4-fa05ba15711d/tokens",
									"protocol": "http",
									"host": [
										"CLD-ALKO-HST7"
									],
									"port": "14213",
									"path": [
										"loyaltyApi",
										"organizations",
										"b9097317-ba90-4354-9da4-fa05ba15711d",
										"tokens"
									]
								}
							},
							"response": []
						},
						{
							"name": "Получение токена лояльности (Демо 2)",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer 01a638c2-6856-4632-8748-94c5561c3f3a",
										"type": "text",
										"disabled": true
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n\"token\": \"e1698a45-96d2-47cf-84ee-d92b1fb6c487\",\r\n\"shopId\": \"d6238bdd-ab5b-4d88-82d1-e220ba652187\",\r\n\"cashboxId\": \"c235629b-ad96-4b89-90ee-2ce4e5575fa5\"\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://CLD-ALKO-HST9:18973/loyaltyApi/organizations/5d853691-73cb-4089-af9e-e24dadce117a/tokens",
									"protocol": "http",
									"host": [
										"CLD-ALKO-HST9"
									],
									"port": "18973",
									"path": [
										"loyaltyApi",
										"organizations",
										"5d853691-73cb-4089-af9e-e24dadce117a",
										"tokens"
									]
								}
							},
							"response": []
						},
						{
							"name": "Все акции (от кассы) (Магазин)",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "Authorization",
										"value": "Bearer 9e58da34-7508-4b8b-9518-4dd140cb0145",
										"type": "text"
									}
								],
								"url": {
									"raw": "https://market.testkontur.ru/loyaltyCashboxApi/v1/promotions/withVersion",
									"protocol": "https",
									"host": [
										"market",
										"testkontur",
										"ru"
									],
									"path": [
										"loyaltyCashboxApi",
										"v1",
										"promotions",
										"withVersion"
									]
								}
							},
							"response": []
						},
						{
							"name": "Все акции (от кассы) (Демо 2)",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "Authorization",
										"value": "Bearer e1698a45-96d2-47cf-84ee-d92b1fb6c487",
										"type": "text"
									}
								],
								"url": {
									"raw": "https://market.testkontur.ru/loyaltyCashboxApi/v1/promotions/withVersion",
									"protocol": "https",
									"host": [
										"market",
										"testkontur",
										"ru"
									],
									"path": [
										"loyaltyCashboxApi",
										"v1",
										"promotions",
										"withVersion"
									]
								}
							},
							"response": []
						}
					],
					"auth": {
						"type": "apikey"
					},
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					]
				},
				{
					"name": "Контур Установочник",
					"item": [
						{
							"name": "Получение списка всех приложений на сервере",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "https://market.testkontur.ru/cashboxApi/updater/v1/applications/ru.kontur.cashbox.staging",
									"protocol": "https",
									"host": [
										"market",
										"testkontur",
										"ru"
									],
									"path": [
										"cashboxApi",
										"updater",
										"v1",
										"applications",
										"ru.kontur.cashbox.staging"
									]
								}
							},
							"response": []
						},
						{
							"name": "Получение списка доступных приложений в КУ",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "CashboxUpdater-CashboxId",
										"value": "5422bf86-f676-4a73-8155-bc8e7660aa07",
										"type": "text",
										"disabled": true
									},
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "CashboxUpdater-Admin-Token",
										"value": "STAGING",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "\"applicationId\": \"KS-5874\",\r\n\"title\": \"KS-5874\",\r\n\"description\": \"KS-5874\",\r\n\"priority\": \"1\"",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "https://market.testkontur.ru/cashboxApi/updater/v1/applications/ru.kontur.cashbox.staging",
									"protocol": "https",
									"host": [
										"market",
										"testkontur",
										"ru"
									],
									"path": [
										"cashboxApi",
										"updater",
										"v1",
										"applications",
										"ru.kontur.cashbox.staging"
									]
								}
							},
							"response": []
						}
					],
					"auth": {
						"type": "basic",
						"basic": [
							{
								"key": "username",
								"value": "admin",
								"type": "string"
							},
							{
								"key": "password",
								"value": "STAGING",
								"type": "string"
							}
						]
					},
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					]
				},
				{
					"name": "Стор на тачках",
					"item": [
						{
							"name": "Создать кассу с доставкой",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n    \"ytipsUrl\": null,\r\n    \"loyaltyQrPrintingEnabled\": false,\r\n    \"deliveryCashboxes\": [\r\n        \"056f3819-ac15-467a-a7c9-d22c70440e2e\"\r\n    ]\r\n}"
								},
								"url": {
									"raw": "{{server}}/store/v1/shops/{{shop}}/commonSettings",
									"host": [
										"{{server}}"
									],
									"path": [
										"store",
										"v1",
										"shops",
										"{{shop}}",
										"commonSettings"
									]
								}
							},
							"response": []
						}
					]
				}
			],
			"description": "Folder for v1"
		}
	],
	"auth": {
		"type": "basic",
		"basic": [
			{
				"key": "password",
				"value": "{{password}}",
				"type": "string"
			},
			{
				"key": "username",
				"value": "{{username}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "cashboxId",
			"value": "",
			"type": "string"
		},
		{
			"key": "shiftId",
			"value": "",
			"type": "string"
		},
		{
			"key": "username",
			"value": "admin",
			"type": "string"
		},
		{
			"key": "password",
			"value": "psw",
			"type": "string"
		},
		{
			"key": "base_url",
			"value": "https://market.testkontur.ru:443/cashboxApi/backend",
			"type": "string"
		},
		{
			"key": "prepare_request",
			"value": "(url_tail) => {\n    var cashboxId = pm.collectionVariables.get(\"cashboxId\");\n    var base_url = pm.collectionVariables.get(\"base_url\");\n    var version = pm.request.url.variables.get('version')\n    if (version == null) {\n        version = 'v1'\n    }\n    var request_url = base_url + '/' + version + '/cashbox/' + cashboxId + '/' + url_tail;\n    const getRequest = {\n        url: request_url,\n        method: 'GET',\n        header: {\n            'Content-Type': 'application/json',\n            'Authorization': 'Basic ' + btoa(pm.collectionVariables.get(\"username\") + ':' + pm.collectionVariables.get(\"password\"))\n        },\n    };\n    return getRequest;\n}",
			"type": "string"
		},
		{
			"key": "cashier_version",
			"value": ""
		},
		{
			"key": "server",
			"value": "http://xlt-hst-dev04.dev.kontur.ru:20170",
			"type": "string"
		},
		{
			"key": "shop",
			"value": "55a55bd4-7169-4065-91e3-2f3ae3ce588e",
			"type": "string"
		}
	]
}