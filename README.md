ManualTestsHelper - скрипты, которые автоматизируют рутинные действия при проверках на виндовой кассе. 

Пожелания и предложения пишите автору: https://staff.skbkontur.ru/profile/mnoskov

## Как запустить

1. Откройте командную строку и проверьте, установлен ли питон: python --version. Если нет, а) просто введите python - тогда откроется Microsoft Store. И можно скачать питон оттуда. б) или скачайте питон вручную. Тогда обязательно поставьте галку "добавить в path": https://www.python.org/downloads/ 
2. Выкачайте этот репозиторий 
3. Запустите main.py

При первом запуске установятся все необходимые библиотеки. И в этой же папке появится файл data.json - сюда будут кэшироваться данные. Например, последняя введенная марка. 

Если при запуске нет админских прав - скрипты автоматически перезапускаются из-под админа. В этом случае при старте вы увидите, как вместо одного окошка консоли появляется другое - и дальше все будет, как обычно. 

## Как пользоваться

Просто запустите main.py - и горячие клавиши будут готовы. Например, нажмите alt + g - и сгенерируется произвольный guid.

Вариант для тех, кто не любит горячие клавиши - режим консольных команд. Нажмите alt + q для перехода в него. 
Тогда, например, нужно будет вводить "guid", чтобы сгенерировать guid. Все подсказки по командам всегда будут под рукой.

Приложение будет работать, пока не закроете консоль. Если заблокировать и разблокировать экран - оно автоматически перезапустится (иначе горячие клавиши не будут работать). Поэтому при работе с консолью необходимо снова нажать alt + q.

## Как скрипты заменяют марки и сканер

Для добавления маркированных товаров нам нужны: а) коды марок, б) возможность вставлять их при помощи эмуляции клавиатуры. Скрипты решают обе проблемы: генерируют коды и выводят их на клавиатуре посимвольно. 

Основные сценарии использования:

1. Добавить один маркированный товар. В скриптах есть возможность выбрать разные виды маркировки + сигареты с определенным МРЦ.
2. Добавить несколько одинаковых маркированных товаров. Скрипт генерирует каждый раз разные марки, поэтому не возникнет ошибки "этот товар уже есть в чеке"
3. Добавить алкоголь. Особенность алкоголя: при выборе этого варианта в консоли марка не сгенерируется, а скопируется рандомом из папки marks. Если необходима проверка марок в Маркете (например, для выяснения МРЦ) - в идеале, надо засунуть марки из накладной WayBill в этот файл. Либо копировать из буфера.
4. Вставить конкретную марку из буфера (например, взять её в аналитике). При нажатии горячей клавиши есть возможность выбрать вариант "из буфера"
5. Вставить предыдущую марку снова. Каждая марка кэшируется в файле data.json. При нажатии клавиш ALT + Shift + S - вставится марка, которую вы использовали в прошлый раз.
6. Одновременно добавить товар и считать марку. Это возможно, потому что для генерации марок используется штрихкод из файла data.json. Укажите там штрихкод своего маркированного товара в поле barcode - и добавлять его станет проще.

Дисклеймеры: 
1. Сгенерированные марки не проходят проверку ОИСМ успешно. Если это необходимо, придётся пользоваться сканером. 
2. Для тестирования задач по маркировке сгенерированных марок порой будет недостаточно. Потому что есть старые и новые форматы, российская и белорусская молочка, весовые и невесовые товары и т.д. В этом случае придётся искать необходимые марки и вставлять из буфера обмена. В скрипты все многообразие маркировки засунуть непросто и не планируется :)